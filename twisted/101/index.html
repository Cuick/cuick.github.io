<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Twisted学习笔记1 // 崔程凯
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.16-DEV" />

  <meta property="og:title" content="Twisted学习笔记1" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://cuick.github.io/twisted/101/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="http://cuick.github.io//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="崔程凯" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	

    
    

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://cuick.github.io/">Home</a></li>
        
      </ul>
    </nav>

    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
		    <div id="toc" class="pure-u-1 pure-u-md-1-4">
				<small class="toc-label">Contents</small>
		   	 	<nav id="TableOfContents">
<ul>
<li><a href="#网络编程:e4b8a5905536b2b2540aab2195e920f5">网络编程</a></li>
<li><a href="#reactor:e4b8a5905536b2b2540aab2195e920f5">Reactor</a>
<ul>
<li>
<ul>
<li><a href="#一个真正reactor模式的实现是需要实现循环独立抽象出来并具有如下的功能:e4b8a5905536b2b2540aab2195e920f5">一个真正reactor模式的实现是需要实现循环独立抽象出来并具有如下的功能：</a></li>
<li><a href="#一个设计优秀的reactor模式实现需要做到:e4b8a5905536b2b2540aab2195e920f5">一个设计优秀的reactor模式实现需要做到：</a></li>
<li><a href="#reactor特性:e4b8a5905536b2b2540aab2195e920f5">reactor特性</a></li>
<li><a href="#使用twisted-internet-pollreactor中的系统调用来poll-来代替select方法:e4b8a5905536b2b2540aab2195e920f5">使用twisted.internet.pollreactor中的系统调用来poll 来代替select方法</a></li>
</ul></li>
</ul></li>
<li><a href="#twisted:e4b8a5905536b2b2540aab2195e920f5">Twisted</a>
<ul>
<li>
<ul>
<li><a href="#注意点:e4b8a5905536b2b2540aab2195e920f5">注意点：</a></li>
<li><a href="#transports:e4b8a5905536b2b2540aab2195e920f5">Transports</a></li>
<li><a href="#protocols:e4b8a5905536b2b2540aab2195e920f5">Protocols</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
		    </div>
		    
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/twisted/101/">Twisted学习笔记1</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>27</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Feb</span> <span class="post-date-year">2016</span>
            	</span>
            	
            
            	
            

			
			

			

			

            

<h1 id="网络编程:e4b8a5905536b2b2540aab2195e920f5">网络编程</h1>

<ul>
<li>socket</li>
<li>select</li>
<li>poll</li>
<li>epoll</li>
<li>greenlet</li>
<li>gevent</li>
<li>gevent是基于协程的高性能Python网络库，相比Twisted、Stackless等，gevent使用libev事件循环，因此速度很快、性能很好，使用greenlet提供高层的同步API，因此非常轻量。</li>
<li><a href="http://www.elias.cn/Python/PyConcurrency">http://www.elias.cn/Python/PyConcurrency</a></li>
<li><a href="http://blog.csdn.net/yueguanghaidao/">http://blog.csdn.net/yueguanghaidao/</a></li>
</ul>

<h1 id="reactor:e4b8a5905536b2b2540aab2195e920f5">Reactor</h1>

<h3 id="一个真正reactor模式的实现是需要实现循环独立抽象出来并具有如下的功能:e4b8a5905536b2b2540aab2195e920f5">一个真正reactor模式的实现是需要实现循环独立抽象出来并具有如下的功能：</h3>

<ol>
<li>监视一系列与你I/O操作相关的文件描述符（description)</li>
<li>不停地向你汇报那些准备好I/O操作的文件描述符</li>
</ol>

<h3 id="一个设计优秀的reactor模式实现需要做到:e4b8a5905536b2b2540aab2195e920f5">一个设计优秀的reactor模式实现需要做到：</h3>

<ol>
<li>处理所有不同系统会出现的I/O事件</li>
<li>提供优雅的抽象来帮助你在使用reactor时少花些心思去考虑它的存在</li>
<li>提供你可以在抽象层外（treactor实现）使用的公共协议实现。</li>
</ol>

<h3 id="reactor特性:e4b8a5905536b2b2540aab2195e920f5">reactor特性</h3>

<ol>
<li>Twisted的reactor只有通过调用reactor.run()来启动。</li>
<li>reactor循环是在其开始的进程中运行，也就是运行在主进程中。</li>
<li>一旦启动，就会一直运行下去。reactor就会在程序的控制下（或者具体在一个启动它的线程的控制下）。</li>
<li>reactor循环并不会消耗任何CPU的资源。</li>
<li>并不需要显式的创建reactor，只需要引入就OK了。</li>
</ol>

<h3 id="使用twisted-internet-pollreactor中的系统调用来poll-来代替select方法:e4b8a5905536b2b2540aab2195e920f5">使用twisted.internet.pollreactor中的系统调用来poll 来代替select方法</h3>

<p>from twited.internet import pollreactor<br />
pollreactor.install()<br />
from twisted.internet import reactor<br />
reactor.run()</p>

<h1 id="twisted:e4b8a5905536b2b2540aab2195e920f5">Twisted</h1>

<h3 id="注意点:e4b8a5905536b2b2540aab2195e920f5">注意点：</h3>

<ol>
<li>在一个回调函数执行过程中，实际上Twisted的循环是被有效地阻塞在我们的代码上的。因此，因此我们应该确保回调函数不要浪费时间（尽快返回）。</li>
<li>很多标准的Python方法没有办法转换为非阻塞方式。例如，os.system中的很多方法会在子进程完成前一直处于阻塞状态。这也就是它工作的方式。所以当你使用Twisted时，避开使用os.system。</li>
</ol>

<h3 id="transports:e4b8a5905536b2b2540aab2195e920f5">Transports</h3>

<ul>
<li>一个Twisted的Transport代表一个可以收发字节的单条连接。对于我们的诗歌下载客户端而言，就是对一条TCP连接的抽象。</li>
<li>ransport抽象可以代表任何这样的连接并为其代表的连接处理具体的异步I/O操作细节。</li>
</ul>

<h3 id="protocols:e4b8a5905536b2b2540aab2195e920f5">Protocols</h3>

<ul>
<li>一个具体的Twisted的Protocol的实现应该对应一个具体网络协议的实现，像FTP、IMAP或其它我们自己规定的协议。</li>
<li>每一个Twisted的Protocols类实例都为一个具体的连接提供协议解析。</li>
<li>Protocol实例是存储协议状态与间断性接收并累积数据的地方（由于我们是通过异步I/O方式以任意大小来接收数据的）。</li>
<li>Protocol实例如何得知它为哪条连接服务呢？如果你阅读IProtocol定义会发现一个makeConnection函数。这是一个回调函数，Twisted会在调用它时传递给其一个也是仅有的一个参数，即就是Transport实例。这个Transport实例就代表Protocol将要使用的连接。</li>
</ul>

	
			

			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/notes/notes/">notes</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>&copy; 2016. All rights reserved.</p>
</div>
    </div>
  </div>
	

	

  
</body>
</html>
